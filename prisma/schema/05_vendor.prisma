///ตารางเก็บข้อมูลเจ้าหนี้ M3
model vendor {
    ///รหัสเจ้าหนี้
    vendor_id         Int      @id @default(autoincrement())
    ///รหัสเจ้าหนี้
    vendor_code       String   @db.VarChar(30)
    ///ชื่อเจ้าหนี้
    vendor_name       String   @db.VarChar(255)
    ///เลขที่ผู้เสียภาษี
    tax_id            String?  @db.VarChar(20)
    /// จด VAT หรือไม่
    is_vat_registered Boolean  @default(false)
    /// เครดิตเทอม (วัน)
    payment_term_days Int
    ///เบอร์โทรศัพท์
    phone             String?  @db.VarChar(20)
    ///อีเมล
    email             String?  @db.VarChar(255)
    ///สถานะ
    is_active         Boolean  @default(true)
    created_at        DateTime @default(now())
    updated_at        DateTime @updatedAt
    ///รหัสประเภทเจ้าหนี้
    vendor_type_id    Int
    ///รหัสกลุ่มเจ้าหนี้
    vendor_group_id   Int
    ///สกุลเงิน
    currency_id       Int?

    vendor_type        vendor_type            @relation(fields: [vendor_type_id], references: [vendor_type_id])
    vendor_group       vendor_group           @relation(fields: [vendor_group_id], references: [vendor_group_id])
    currency           currency?              @relation(fields: [currency_id], references: [currency_id])
    prLines            pr_line[]
    rfqLines           rfq_line[]
    vendorAddresses    vendor_address[]
    vendorContacts     vendor_contacts[]
    vendorBankAccounts vendor_bank_accounts[]
    vendorDocuments    vendor_documents[]
    vendorPerformances vendor_performance[]

    @@map("vendor")
}

model vendor_address {
    vendor_address_id Int @id @default(autoincrement())
    vendor_id         Int

    /// REGISTERED / CONTACT / BILLING / SHIPPING
    address_type    VendorAddressType
    /// ที่อยู่
    address         String            @db.Text
    /// อำเภอ
    district        String?           @db.VarChar(100)
    /// จังหวัด
    province        String?           @db.VarChar(100)
    /// รหัสไปรษณีย์
    postal_code     String?           @db.VarChar(10)
    /// ประเทศ
    country         String            @db.VarChar(100)
    /// ผู้ติดต่อ
    contact_person  String?           @db.VarChar(255)
    /// เบอร์โทรศัพท์
    phone           String?           @db.VarChar(20)
    /// ต่อ
    phone_extension String?           @db.VarChar(20)
    /// อีเมล
    email           String?           @db.VarChar(255)
    /// สถานะ
    is_default      Boolean           @default(false)
    /// สถานะ
    is_active       Boolean           @default(true)

    vendor vendor @relation(fields: [vendor_id], references: [vendor_id])

    @@index([vendor_id])
    @@map("vendor_address")
}

enum VendorAddressType {
    REGISTERED // ที่อยู่ตามเลขผู้เสียภาษี
    CONTACT // ที่อยู่ติดต่อ
    BILLING // วางบิล
    SHIPPING // ส่งของ
}

//ตารางเก็บข้อมูลประเภทเจ้าหนี้
model vendor_type {
    ///รหัสประเภทเจ้าหนี้
    vendor_type_id      Int      @id @default(autoincrement())
    ///รหัสประเภทเจ้าหนี้
    vendor_type_code    String   @db.VarChar(30)
    ///ชื่อประเภทเจ้าหนี้
    vendor_type_name    String   @db.VarChar(200)
    ///ชื่อประเภทเจ้าหนี้ (อังกฤษ)
    vendor_type_nameeng String   @db.VarChar(200)
    ///รายละเอียดประเภทเจ้าหนี้
    description         String
    ///สถานะประเภทเจ้าหนี้
    status              String   @db.VarChar(20)
    created_at          DateTime @default(now())
    updated_at          DateTime @updatedAt
    vendors             vendor[]

    @@map("vendor_type")
}

/// ตารางกลุ่มเจ้าหนี้
model vendor_group {
    ///รหัสกลุ่มเจ้าหนี้
    vendor_group_id      Int      @id @default(autoincrement())
    ///รหัสกลุ่มเจ้าหนี้
    vendor_group_code    String   @db.VarChar(30)
    ///ชื่อกลุ่มเจ้าหนี้
    vendor_group_name    String   @db.VarChar(200)
    ///ชื่อกลุ่มเจ้าหนี้ (อังกฤษ)
    vendor_group_nameeng String   @db.VarChar(200)
    ///รายละเอียดกลุ่มเจ้าหนี้
    description          String
    ///สถานะกลุ่มเจ้าหนี้
    status               String   @db.VarChar(20)
    created_at           DateTime @default(now())
    updated_at           DateTime @updatedAt
    vendors              vendor[]

    @@map("vendor_group")
}

/// ตารางผู้ติดต่อ
model vendor_contacts {
    /// ชื่อผู้ติดต่อ
    contact_name String   @db.VarChar(100)
    /// ตำแหน่ง
    position     String?  @db.VarChar(100)
    /// แผนก
    department   String?  @db.VarChar(100)
    /// เบอร์โทรศัพท์
    phone        String?  @db.VarChar(20)
    /// เบอร์มือถือ
    mobile       String?  @db.VarChar(20)
    /// อีเมล
    email        String?  @db.VarChar(100)
    /// เป็นผู้ติดต่อหลักหรือไม่
    is_primary   Boolean  @default(false)
    /// วันที่สร้างข้อมูล
    created_at   DateTime @default(now())
    /// วันที่แก้ไขล่าสุด
    updated_at   DateTime @updatedAt
    /// รหัสผู้ติดต่อ (PK)
    contact_id   Int      @id @default(autoincrement())
    /// รหัสอ้างอิงเจ้าหนี้ (FK → vendor_master.vendor_id)
    vendor_id    Int
    vendor       vendor   @relation(fields: [vendor_id], references: [vendor_id])

    @@index([vendor_id])
}

/// ตารางเก็บข้อมูลบัญชีธนาคารของเจ้าหนี้
model vendor_bank_accounts {
    /// ชื่อธนาคาร
    bank_name       String  @db.VarChar(100)
    /// สาขาธนาคาร
    bank_branch     String  @db.VarChar(100)
    /// เลขที่บัญชีธนาคาร
    account_no      String  @db.VarChar(30)
    /// ชื่อบัญชี
    account_name    String  @db.VarChar(200)
    /// ประเภทบัญชี SAVING / CURRENT
    account_type    String  @db.VarChar(20)
    /// รหัส SWIFT (ถ้ามี)
    swift_code      String? @db.VarChar(20)
    /// เป็นบัญชีหลักของเจ้าหนี้หรือไม่
    is_default      Boolean @default(false)
    /// PK รหัสบัญชีธนาคาร
    bank_account_id Int     @id @default(autoincrement())
    /// FK รหัสอ้างอิงเจ้าหนี้ (FK → vendor_master.vendor_id)
    vendor_id       Int
    vendor          vendor  @relation(fields: [vendor_id], references: [vendor_id])

    @@index([vendor_id])
    @@map("vendor_bank_accounts")
}

/// ตารางเอกสารประกอบของเจ้าหนี้
model vendor_documents {
    /// ประเภทเอกสาร
    document_type String?   @db.VarChar(50)
    /// เลขที่เอกสาร
    document_no   String?   @db.VarChar(50)
    /// วันที่ออกเอกสาร
    issue_date    DateTime? @db.Date
    /// วันหมดอายุ
    expiry_date   DateTime? @db.Date
    /// ที่อยู่ไฟล์
    file_path     String?   @db.VarChar(500)
    /// ชื่อไฟล์
    file_name     String?   @db.VarChar(200)
    /// หมายเหตุ
    remark        String?
    /// วันที่สร้างข้อมูล
    created_at    DateTime  @default(now())
    /// วันที่แก้ไขล่าสุด
    updated_at    DateTime  @updatedAt
    /// รหัสเอกสาร (PK)
    document_id   Int       @id @default(autoincrement())
    /// รหัสอ้างอิงเจ้าหนี้ (FK → vendor_master.vendor_id)
    vendor_id     Int
    vendor        vendor    @relation(fields: [vendor_id], references: [vendor_id])

    @@index([vendor_id])
    @@map("vendor_documents")
}

/// ตารางบันทึกผลการประเมินเจ้าหนี้
model vendor_performance {
    /// รหัสการประเมิน (PK)
    performance_id    Int       @id @default(autoincrement())
    /// รหัสอ้างอิงเจ้าหนี้ (FK → vendor_master.vendor_id)
    vendor_id         Int
    /// วันที่ประเมิน
    evaluation_date   DateTime? @db.Date
    /// งวดการประเมิน
    evaluation_period String?   @db.VarChar(20)
    /// คะแนนคุณภาพ
    quality_score     Decimal?  @db.Decimal(5, 2)
    /// คะแนนการส่งมอบ
    delivery_score    Decimal?  @db.Decimal(5, 2)
    /// คะแนนราคา
    price_score       Decimal?  @db.Decimal(5, 2)
    /// คะแนนบริการ
    service_score     Decimal?  @db.Decimal(5, 2)
    /// คะแนนรวม
    total_score       Decimal?  @db.Decimal(5, 2)
    /// เกรดประเมิน
    rating            String?   @db.VarChar(1)
    /// หมายเหตุ
    remark            String?
    /// ผู้ประเมิน
    evaluated_by      String?   @db.VarChar(50)
    /// วันที่สร้างข้อมูล
    created_at        DateTime  @default(now())
    /// วันที่แก้ไขล่าสุด
    updated_at        DateTime  @updatedAt
    vendor            vendor    @relation(fields: [vendor_id], references: [vendor_id])

    @@map("vendor_performance")
}

/// ตารางหมวดหมู่เจ้าหนี้
model vendor_categories {
    /// รหัสหมวดหมู่ (PK)
    category_id        Int      @id @default(autoincrement())
    /// รหัสหมวดหมู่
    category_code      String?  @db.VarChar(20)
    /// ชื่อหมวดหมู่
    category_name      String?  @db.VarChar(100)
    /// รหัสหมวดหมู่แม่
    parent_category_id String?  @db.VarChar(20)
    /// สถานะการใช้งาน
    is_active          Boolean?

    @@map("vendor_categories")
}

/// ตารางเงื่อนไขการชำระ
model payment_terms {
    /// รหัสเงื่อนไขการชำระ (PK)
    payment_term_id Int      @id @default(autoincrement())
    /// รหัสเงื่อนไข
    term_code       String?  @db.VarChar(20)
    /// ชื่อเงื่อนไข
    term_name       String?  @db.VarChar(100)
    /// จำนวนวัน
    days            Int?
    /// สถานะการใช้งาน
    is_active       Boolean?

    @@map("payment_terms")
}
